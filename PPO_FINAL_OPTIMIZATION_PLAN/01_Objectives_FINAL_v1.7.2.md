# PPO_project 目标文档（FINAL v1.7.2）
版本日期：2025-12-30  
面向：RCIM 投稿 + 可复现代码工件（Artifact）

本文回答两个问题：  
1) 你“想让系统学会什么”（科学问题）  
2) 你“用什么指标证明它学会了”（验收与论文）

---

## 1) 总目标（系统层面）
在轮廓误差容许带（tolerance band，±ε/2）约束下学习策略 π，使其在不同轨迹族上同时满足：

- **直线段**：高进给、贴线（误差不超带）
- **拐角段**：容许带内自动平滑（降低“转弯激烈程度”，降速尽量少）
- **全程**：到达终点、无停滞、运动学约束零违规（由 KCM/action shielding 保证或统计证明）

---

## 2) 基线层级（你后续所有对比的“尺子”）
- Level-1：P0_gold（训练得到的最好权重/checkpoint）
- Level-2：P0_L2（按统一标准封存的实验层基线 Run Bundle）

从 PhaseB 开始，**所有 baseline_ref 指向 P0_L2，而不是直接指向某次训练目录。**

---

## 3) 验收维度（论文可直接用的“主表字段”）
为避免指标过多导致“调参无穷无尽”，建议把指标分成三组：必须项 / 解释项 / 诊断项。

### 3.1 必须项（主表 / 主结论）
这些必须项要满足“不退化”或“明显改善”，否则 PhaseB 的提升不成立。

1) **可达性**  
- reached_target 或 success_rate（按你当前 eval 输出定义）  
- 要求：baseline_ref 同等或更好；并且失败原因可追溯

2) **误差约束（贴线）**  
- max_abs_e_n（全程）  
- 建议同时提供 rmse_e_n（可从 trace 计算，若当前没有就作为后续可选增强）  
- 要求：不超过 baseline_ref 的容忍比例（例如 1.05 倍）

3) **效率（时间/步数）**  
- cycle_time_steps 或 steps（到达终点所需步数）  
- 要求：不劣于 baseline_ref 的容忍比例（例如 1.05 倍）

4) **硬约束**  
- kcm_violation_rate = 0（若当前未统计，至少要保证机制上不可能违规；最好补齐统计）  
- 要求：严格为 0 或在 manifest 中明确说明“未统计但由 shielding 保证”

### 3.2 解释项（论文叙事用）
这些用来解释“为什么更好”，不是 PASS/FAIL 的唯一依据。

- v_profile：直线段速度更高、拐角段速度下降更少
- corner_mask 分段统计：把直线与拐角拆开，避免“全程平均掩盖拐角表现”

### 3.3 诊断项（调试用，不直接进主表）
- stall_rate / done_reason 分布（卡死、越界、max_steps）
- has_non_finite（数值稳定性）
- cap_ang_active_ratio / corner_mode_ratio 等内部状态占比（如果你已在 trace 里统计）

---

## 4) PhaseB 的“平滑”到底是什么（必须可度量）
你的核心创新点之一是“拐角平滑且降速最小”。建议至少给出三类平滑性指标（都可以从 trace 计算，不必改训练逻辑）：

- **角速度峰值**：peak(|ω|)
- **角速度变化强度**：mean(|Δω|) 或近似 |dω/dt|
- **拐角段速度跌落幅度**：min(v_corner)/mean(v_straight) 或类似比值

要求（推荐写入 PhaseB2 的验收规则）：
- 平滑性指标相对 baseline_ref 有显著改善（阈值或统计规则由你定）
- 同时满足 3.1 的“不退化”约束

---

## 5) 通过判定（建议统一到 Run Bundle 的 verdict 里）
- 必须项全部 PASS：进入下一阶段
- 必须项有 FAIL：允许落盘（仍然生成 Run Bundle），但必须在 verdict 写明失败原因与主要触发指标

---

## 6) 结账：每次 run 必须固化（A-1 Run Bundle）
任何训练/改动完成后，都必须通过 A-1 把本次结果固化为 Run Bundle（含 manifest、评测产物、baseline_ref）。  
否则这次 run 在论文角度等价于“没发生过”。

