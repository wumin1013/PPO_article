# Phase B2a：拐角平滑（学习驱动）（FINAL v1.7.2）
版本日期：2025-12-30  
依赖：B1 已通过（7维或 Plan B）。Run Bundle 体系必须可用（A-1 PASS）。

---

## 1) B2a 目标（你论文最在意的那一部分）
- 相对 baseline_ref（P0_L2）：拐角段平滑性显著改善
- 相对 baseline_ref：直线段不退化（贴线与速度/时间不劣化）
- 全程硬约束满足：KCM 零违规（或机制保证并有统计/说明）

---

## 2) 关键原则：平滑必须“可计算、可复现、可对比”
为了避免“主观感觉更顺”，B2a 的每次 run 必须产出可计算指标：
- 拐角 mask（如何判定拐角段）
- 分段统计（直线 vs 拐角）
- 平滑性指标（至少一到两个稳定代理，如 |Δω|、peak(|ω|) 等）

这些指标建议从 trace 计算，避免为了统计去改训练逻辑。

---

## 3) 改动类型约束（写进系统）
B2a 允许你在 Shaping 上大胆，但必须遵守：
- 不允许“偷偷改动力学”来制造平滑（Hard-impact 必须可开关并记录）
- 任何能影响动作执行的滤波/限幅，都要被归类为 Hard-impact，并记录 enable 状态与参数

---

## 4) 执行节奏（推荐）
- 先用少量 seed 验证：平滑指标是否有趋势提升，同时必须项不退化
- 再扩到多 seed 做统计：避免偶然 seed

---

## 5) B2a 的 Run Bundle 必须包含什么（除了 A-1 的通用内容）

### A1 归档要求（本阶段强制）

- **本阶段每一次 run（训练 / 评估 / 消融），无论 PASS/FAIL，都必须按 A1 归档规范生成 Run Bundle（Level-2）。**
- PASS 的前提：该 run 已形成完整 Run Bundle，且 summary.verdict=PASS。  
  （换句话说：没有归档，就不存在“通过”。）
- 失败 run 也必须归档：这是定位退化/漂移/偶发性的唯一可靠证据链。

- 明确的 baseline_ref（指向 P0_L2）
- 本次平滑性指标（aggregate + per_episode/分段统计）
- 关键开关组合（Hard-impact / Shaping / Observability）与其参数快照
- verdict：如果 FAIL，写清楚是“不退化失败”还是“平滑未改善”

---

## 6) B2a 的 PASS/FAIL（建议）
PASS：
- 必须项：相对 baseline_ref 不退化（误差与时间在容忍范围内，成功率不下降）
- 平滑性：至少一个主指标显著改善（阈值或统计规则写入 verdict）
- 解释性：能从 trace/分段统计解释改善发生在拐角，而不是靠整体降速

FAIL：
- 直线退化（速度/时间明显变差）
- 或平滑改善只靠全程降速实现（论文不买账）

