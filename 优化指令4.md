# Role
你是一名资深的数控系统（CNC）算法专家，精通强化学习的底层动力学建模。

# Context
我将一个单文件 RL 脚本 `PPO最终版_改进.py` 重构为了模块化项目 `PPO_project`。
**当前严重问题：** 训练出来的轨迹非常“扭曲”（Twisted/Jittery），呈现高频锯齿状，不像老脚本那样平滑。这说明物理动力学参数或平滑惩罚出了大问题。

# Task: 动力学参数与平滑性的“法医级”排查
请阅读 `PPO最终版_改进.py` 和 `PPO_project` 的 `src/environment/` 下相关文件，执行以下 3 步强制修复：

## 1. 核心动力学参数对齐 (Physics Check)
轨迹扭曲通常是因为物理步长 (`dt`) 或 物理限制 (`Limit`) 不一致。
- **对比文件：** `PPO最终版_改进.py` vs `src/environment/cnc_env.py` (或 `kinematics.py`)
- **强制检查项：**
    1.  **`dt` (插补周期/时间步长)：** 必须严格一致！如果老脚本是 `0.001` 而新项目是 `0.01`，会导致动作幅度放大 10 倍，必然震荡。
    2.  **动作缩放 (`Action Scaling`)：** 检查 `step` 函数中，神经网络输出的 `action` (通常在 [-1, 1]) 是如何转换为物理量（如加速度）的？
        - 老代码公式：$acc = action \times A_{max}$
        - 新代码公式：必须完全一样。如果 $A_{max}$ 变大了，轨迹就会抖动。
- **Action：** 请修改 `src/environment/cnc_env.py`，将 `dt` 和 `max_acceleration` (或类似参数) 强制硬编码为与老脚本完全一致的数值。

## 2. 奖励函数中的“平滑项”修复 (Smoothing Penalty)
RL 智能体天生喜欢通过高频抖动来维持位置平衡，除非你惩罚它。
- **对比文件：** `PPO最终版_改进.py` 的 `calculate_reward` vs `src/environment/reward.py`
- **寻找缺失项：** 老脚本中是否包含类似 `- (action - last_action)^2` 或 `- jerk^2` 的项？
- **Action：** - 如果新项目漏掉了平滑项（Jerk Penalty），请立即在 `src/environment/reward.py` 中补上。
    - **加倍惩罚权重：** 鉴于现在轨迹扭曲严重，请将平滑项的权重系数（如 $\gamma$）暂时**扩大 2 倍**，强制按住智能体的“手抖”。

## 3. PPO 熵系数压制 (Suppress Entropy)
轨迹扭曲的另一个原因是智能体在进行无意义的随机探索（Entropy）。
- **修改文件：** `configs/default.yaml`
- **操作：** 找到 `ent_coef`。
    - 如果它大于 `1e-6`，请将其改为 `0.0` 或极小值 `1e-8`。
    - **原因：** 我们现在需要它先走出一条平滑的线，不需要它做过多的随机探索。

**输出要求：**
1. 指出你在老脚本中发现的 `dt` 和 `平滑奖励系数` 具体是多少。
2. 提供修改后的 `src/environment/cnc_env.py` (包含修正后的动力学) 和 `src/environment/reward.py` (包含加强的平滑惩罚) 代码。